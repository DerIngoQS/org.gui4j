<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Gui4jCellTable.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">gui4j</a> &gt; <a href="index.source.html" class="el_package">org.gui4j.component</a> &gt; <span class="el_source">Gui4jCellTable.java</span></div><h1>Gui4jCellTable.java</h1><pre class="source lang-java linenums">package org.gui4j.component;

import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.Point;
import java.awt.Rectangle;
import java.awt.event.MouseEvent;
import java.io.Serializable;
import java.util.Collection;
import java.util.HashMap;
import java.util.Map;
import javax.swing.JComponent;
import javax.swing.JLabel;
import javax.swing.JTable;
import javax.swing.ListSelectionModel;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.JTableHeader;
import javax.swing.table.TableCellEditor;
import javax.swing.table.TableCellRenderer;
import javax.swing.table.TableColumn;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.gui4j.Gui4jCallBase;
import org.gui4j.Gui4jGetValue;
import org.gui4j.component.util.StringUtil;
import org.gui4j.core.Gui4jCall;
import org.gui4j.core.Gui4jComponentContainer;
import org.gui4j.core.Gui4jComponentInstance;
import org.gui4j.core.Gui4jMap1;
import org.gui4j.core.Gui4jQualifiedComponent;
import org.gui4j.core.Gui4jSwingContainer;
import org.gui4j.core.Gui4jTextAttribute;
import org.gui4j.core.Gui4jThreadManager;
import org.gui4j.core.swing.BooleanTableCellRenderer;
import org.gui4j.core.swing.ComboBoxCellEdit;
import org.gui4j.core.swing.Gui4jCellEditor;
import org.gui4j.core.swing.Gui4jJTable;
import org.gui4j.core.swing.Gui4jRefreshTable;
import org.gui4j.core.swing.Gui4jTableListener;
import org.gui4j.core.swing.MultiLineLabelUI;
import org.gui4j.core.swing.RowHeaderAbstractTableModel;
import org.gui4j.core.swing.RowHeaderTable;
import org.gui4j.core.util.ComboBoxNullItem;
import org.gui4j.event.Gui4jEventListener;

/**
 * Table where display (reflection) methods can be defined for each cell independantly. The table
 * always contains a header row.
 */
public class Gui4jCellTable extends Gui4jJComponent {
  public static final String PARAM_ROW = &quot;row&quot;;
  public static final String PARAM_COL = &quot;col&quot;;
  public static final String PARAM_VALUE = &quot;value&quot;;
  public static final String PARAM_COLVALUE = &quot;colValue&quot;;
  public static final String PARAM_ROWVALUE = &quot;rowValue&quot;;
  public static final String PARAM_LIST = &quot;list&quot;;
  public static final String PARAM_LIST_ITEM = &quot;listItem&quot;;

<span class="nc" id="L61">  protected static final Log mLogger = LogFactory.getLog(Gui4jCellTable.class);</span>

  protected final Gui4jCall[] mRowValue;
  protected final Gui4jCall[] mRowName;
  protected final Gui4jTextAttribute[] mRowTextAttribute;
  protected final String[] mRowIndentation;

  protected final int mRows;
  protected final int mVisibleRows;
  protected final int mCols;
  protected final Gui4jColumnTable[] mColumn;
  protected final Gui4jCell[][] mCell;
  protected final Gui4jThreadManager mGui4jThreadManager;
  protected Gui4jCall[] mRefresh;
  protected Gui4jCall mOnSetValue;
<span class="nc" id="L76">  private boolean mReorderingAllowed = true;</span>
<span class="nc" id="L77">  private boolean mRowSelectionAllowed = true;</span>
<span class="nc" id="L78">  private int mRowSelectionMode = ListSelectionModel.SINGLE_SELECTION;</span>
<span class="nc" id="L79">  private int mColSelectionMode = ListSelectionModel.SINGLE_SELECTION;</span>
  private final boolean mUseRowHeaders;
  private final boolean mUseColumnsHeaders;
  private Gui4jCall mHeaderBackground;
  protected final boolean mAutomaticRefresh;

  /**
   * Constructor for Gui4jCellTable
   *
   * @param gui4jComponentContainer
   * @param id
   * @param rows
   * @param cols
   * @param visibleRows
   * @param useRowHeaders
   * @param useColumnHeaders
   * @param automaticRefresh
   */
  public Gui4jCellTable(
      Gui4jComponentContainer gui4jComponentContainer,
      String id,
      int rows,
      int cols,
      int visibleRows,
      boolean useRowHeaders,
      boolean useColumnHeaders,
      boolean automaticRefresh) {
<span class="nc bnc" id="L106" title="All 2 branches missed.">    super(gui4jComponentContainer, useRowHeaders ? RowHeaderTable.class : Gui4jJTable.class, id);</span>
<span class="nc" id="L107">    mUseRowHeaders = useRowHeaders;</span>
<span class="nc" id="L108">    mUseColumnsHeaders = useColumnHeaders;</span>
<span class="nc" id="L109">    mAutomaticRefresh = automaticRefresh;</span>
<span class="nc" id="L110">    mColumn = new Gui4jColumnTable[cols];</span>
<span class="nc" id="L111">    mRowValue = new Gui4jCall[rows];</span>
<span class="nc" id="L112">    mRowName = new Gui4jCall[rows];</span>
<span class="nc" id="L113">    mRowTextAttribute = new Gui4jTextAttribute[rows];</span>
<span class="nc" id="L114">    mRowIndentation = new String[rows];</span>
<span class="nc bnc" id="L115" title="All 2 branches missed.">    for (int i = 0; i &lt; mRowIndentation.length; i++) {</span>
<span class="nc" id="L116">      mRowIndentation[i] = &quot;&quot;;</span>
    }
<span class="nc" id="L118">    mRows = rows;</span>
<span class="nc" id="L119">    mCols = cols;</span>
<span class="nc bnc" id="L120" title="All 2 branches missed.">    if (visibleRows &gt; rows) {</span>
<span class="nc" id="L121">      mVisibleRows = rows;</span>
    } else {
<span class="nc" id="L123">      mVisibleRows = visibleRows;</span>
    }
<span class="nc" id="L125">    mCell = new Gui4jCell[mRows][mCols];</span>
<span class="nc" id="L126">    mGui4jThreadManager = getGui4j().getGui4jThreadManager();</span>
<span class="nc" id="L127">  }</span>

  /**
   * Sets the headerBackground.
   *
   * @param headerBackground
   */
  public void setHeaderBackground(Gui4jCall headerBackground) {
<span class="nc" id="L135">    mHeaderBackground = headerBackground;</span>
<span class="nc" id="L136">  }</span>

  protected void setProperties(Gui4jComponentInstance gui4jComponentInstance) {
<span class="nc" id="L139">    super.setProperties(gui4jComponentInstance);</span>
<span class="nc" id="L140">    Gui4jCallBase gui4jController = gui4jComponentInstance.getGui4jCallBase();</span>
<span class="nc" id="L141">    Gui4jJTable table = (Gui4jJTable) gui4jComponentInstance.getComponent();</span>
<span class="nc" id="L142">    Font font = table.getFont();</span>
<span class="nc" id="L143">    table.setDefaultEditor(String.class, Gui4jCellEditor.createTextEditor(font, true));</span>
<span class="nc" id="L144">    JTableHeader tableHeader = table.getTableHeader();</span>

<span class="nc" id="L146">    Color headerBackground = null;</span>
<span class="nc bnc" id="L147" title="All 2 branches missed.">    if (mHeaderBackground != null) {</span>
<span class="nc" id="L148">      headerBackground =</span>
          (Color)
<span class="nc" id="L150">              mHeaderBackground.getValueNoParams(gui4jComponentInstance.getGui4jCallBase(), null);</span>
    }

<span class="nc bnc" id="L153" title="All 2 branches missed.">    if (tableHeader != null) {</span>
<span class="nc" id="L154">      tableHeader.setReorderingAllowed(mReorderingAllowed);</span>
<span class="nc" id="L155">      tableHeader.setFont(font);</span>
    }
    {
<span class="nc" id="L158">      JLabel l = new JLabel(&quot;X&quot;);</span>
<span class="nc" id="L159">      l.setFont(font);</span>
<span class="nc" id="L160">      table.setRowHeight(l.getPreferredSize().height + 4);</span>
    }
<span class="nc bnc" id="L162" title="All 2 branches missed.">    if (tableHeader != null) {</span>
      // mLogger.debug(&quot;Setting font to &quot;+font);
<span class="nc" id="L164">      TableCellRenderer renderer = tableHeader.getDefaultRenderer();</span>
<span class="nc" id="L165">      Component c = renderer.getTableCellRendererComponent(table, &quot;&quot;, false, false, 0, 0);</span>
<span class="nc bnc" id="L166" title="All 2 branches missed.">      if (c instanceof JLabel) {</span>
<span class="nc" id="L167">        ((JLabel) c).setUI(MultiLineLabelUI.getInstance());</span>
      }

<span class="nc bnc" id="L170" title="All 2 branches missed.">      if (mHeaderBackground != null) {</span>
<span class="nc bnc" id="L171" title="All 2 branches missed.">        if (headerBackground != null) {</span>
<span class="nc" id="L172">          tableHeader.setBackground(headerBackground);</span>
        }
      }
    }

<span class="nc" id="L177">    int sumWidth = 0;</span>
<span class="nc" id="L178">    double sumWeight = 0.0;</span>
    // double headerHeight = tableHeader.getPreferredSize().getHeight();
<span class="nc bnc" id="L180" title="All 2 branches missed.">    for (int i = 0; i &lt; mColumn.length; i++) {</span>
<span class="nc" id="L181">      TableColumn tableColumn = table.getColumnModel().getColumn(i);</span>
<span class="nc" id="L182">      sumWidth += tableColumn.getPreferredWidth();</span>
<span class="nc" id="L183">      Gui4jColumnTable gui4jColumnTable = mColumn[i];</span>
      String name;
<span class="nc bnc" id="L185" title="All 2 branches missed.">      if (gui4jColumnTable != null) {</span>
<span class="nc" id="L186">        sumWeight += gui4jColumnTable.getWeight();</span>
<span class="nc" id="L187">        name = gui4jColumnTable.getName(gui4jController);</span>
      } else {
<span class="nc" id="L189">        sumWeight += 1.0;</span>
<span class="nc" id="L190">        name = &quot;&quot;;</span>
      }

      // TableCellRenderer renderer = tableHeader.getDefaultRenderer();
      {
<span class="nc" id="L195">        JLabel label = new JLabel(name);</span>
<span class="nc" id="L196">        label.setFont(font);</span>
<span class="nc" id="L197">        label.setUI(MultiLineLabelUI.getInstance());</span>
        /*
         * double height = label.getPreferredSize().getHeight()+4; if
         * (height &gt; headerHeight) { headerHeight = height; }
         */
      }
    }

<span class="nc bnc" id="L205" title="All 2 branches missed.">    for (int i = 0; i &lt; mColumn.length; i++) {</span>
<span class="nc" id="L206">      TableColumn tableColumn = table.getColumnModel().getColumn(i);</span>
<span class="nc" id="L207">      Gui4jColumnTable gui4jColumnTable = mColumn[i];</span>
<span class="nc" id="L208">      double weight = 1.0;</span>
<span class="nc bnc" id="L209" title="All 2 branches missed.">      if (gui4jColumnTable != null) {</span>
<span class="nc" id="L210">        gui4jColumnTable.setColumnAttributes(tableColumn);</span>
<span class="nc" id="L211">        weight = gui4jColumnTable.getWeight();</span>
      }
<span class="nc" id="L213">      tableColumn.setPreferredWidth((int) (sumWidth * weight / sumWeight));</span>
    }

<span class="nc bnc" id="L216" title="All 2 branches missed.">    if (mVisibleRows != -1) {</span>
<span class="nc" id="L217">      Dimension d = new Dimension(table.getPreferredSize());</span>
<span class="nc" id="L218">      d.setSize(d.getWidth(), table.getRowHeight() * mVisibleRows + 3);</span>
<span class="nc" id="L219">      table.setPreferredScrollableViewportSize(d);</span>
    }
    {
<span class="nc" id="L222">      Dimension d = new Dimension(table.getPreferredSize());</span>
<span class="nc" id="L223">      d.setSize(d.getWidth(), table.getRowHeight() * mRows + 3);</span>
<span class="nc" id="L224">      table.setMaximumSize(d);</span>
    }

<span class="nc bnc" id="L227" title="All 2 branches missed.">    if (mUseRowHeaders) {</span>
<span class="nc" id="L228">      Gui4jTableModel tableModel = (Gui4jTableModel) table.getModel();</span>
<span class="nc" id="L229">      JLabel label = new JLabel();</span>
<span class="nc" id="L230">      label.setFont(font);</span>
<span class="nc" id="L231">      int preferredWidth = 10;</span>
<span class="nc bnc" id="L232" title="All 2 branches missed.">      for (int i = 0; i &lt; mRows; i++) {</span>
<span class="nc" id="L233">        label.setText(tableModel.getRowName(i));</span>
<span class="nc" id="L234">        int width = label.getPreferredSize().width + 8;</span>
<span class="nc bnc" id="L235" title="All 2 branches missed.">        if (width &gt; preferredWidth) {</span>
<span class="nc" id="L236">          preferredWidth = width;</span>
        }
      }
<span class="nc" id="L239">      RowHeaderTable ctable = (RowHeaderTable) table;</span>
<span class="nc" id="L240">      ctable.setRowHeaderWidth(preferredWidth);</span>
<span class="nc" id="L241">      ctable.setRowHeaderFont(font);</span>
<span class="nc" id="L242">      ctable.setRowHeaderHeight(table.getRowHeight());</span>

<span class="nc bnc" id="L244" title="All 2 branches missed.">      if (headerBackground != null) {</span>
<span class="nc" id="L245">        ((RowHeaderTable.RowHeaderRenderer) ctable.getRowHeader().getCellRenderer())</span>
<span class="nc" id="L246">            .setBackground(headerBackground);</span>
      }
    }

<span class="nc bnc" id="L250" title="All 2 branches missed.">    if (getGui4j().traceMode()) {</span>
<span class="nc" id="L251">      mLogger.debug(</span>
<span class="nc" id="L252">          &quot;Preferred size of table with id &quot; + getId() + &quot; is &quot; + table.getPreferredSize());</span>
<span class="nc" id="L253">      mLogger.debug(</span>
          &quot;Preferred scrollable viewport size of table with id &quot;
<span class="nc" id="L255">              + getId()</span>
              + &quot; is &quot;
<span class="nc" id="L257">              + table.getPreferredScrollableViewportSize());</span>
    }
<span class="nc" id="L259">  }</span>

  protected Gui4jComponentInstance createComponentInstance(
      Gui4jSwingContainer gui4jSwingContainer,
      Gui4jCallBase gui4jCallBase,
      Gui4jQualifiedComponent gui4jComponentInPath) {
<span class="nc" id="L265">    Gui4jTableModel tm = new Gui4jTableModel(gui4jSwingContainer, gui4jCallBase);</span>

<span class="nc" id="L267">    registerEvents(gui4jSwingContainer, gui4jCallBase, mRefresh, tm);</span>

    Gui4jJTable table;
<span class="nc bnc" id="L270" title="All 2 branches missed.">    if (mUseRowHeaders) {</span>
<span class="nc" id="L271">      table = new RowHeaderTable(tm, tm);</span>
    } else {
<span class="nc" id="L273">      table = new Gui4jJTable(tm, tm);</span>
    }
<span class="nc bnc" id="L275" title="All 2 branches missed.">    if (!mUseColumnsHeaders) {</span>
<span class="nc" id="L276">      table.setTableHeader(null);</span>
      // table.getTableHeader().setVisible(mUseColumnsHeaders);
    }
<span class="nc" id="L279">    table.getSelectionModel().setSelectionMode(mRowSelectionMode);</span>
<span class="nc" id="L280">    table.getColumnModel().getSelectionModel().setSelectionMode(mColSelectionMode);</span>
<span class="nc" id="L281">    table.setRowSelectionAllowed(mRowSelectionAllowed);</span>
<span class="nc" id="L282">    Gui4jComponentInstance gui4jComponentInstance =</span>
        new Gui4jComponentInstance(gui4jSwingContainer, table, gui4jComponentInPath);
<span class="nc" id="L284">    tm.setGui4jComponentInstance(gui4jComponentInstance);</span>
<span class="nc" id="L285">    gui4jComponentInstance.setStorage(Gui4jTable.class, tm);</span>

<span class="nc" id="L287">    TableCellRenderer renderer = new CellRenderer(gui4jComponentInstance, table, tm);</span>
<span class="nc" id="L288">    table.setDefaultRenderer(String.class, renderer);</span>
<span class="nc" id="L289">    table.setDefaultRenderer(Boolean.class, renderer);</span>

<span class="nc" id="L291">    return gui4jComponentInstance;</span>
  }

  protected void setColumn(int col, Gui4jColumnTable gui4jColumnTable) {
<span class="nc" id="L295">    mColumn[col] = gui4jColumnTable;</span>
<span class="nc" id="L296">  }</span>

  public Class getColumnValueType(int col) {
<span class="nc" id="L299">    Gui4jColumnTable gui4jColumnTable = mColumn[col];</span>
<span class="nc bnc" id="L300" title="All 2 branches missed.">    if (gui4jColumnTable != null) {</span>
<span class="nc" id="L301">      return gui4jColumnTable.getColumnClass();</span>
    } else {
<span class="nc" id="L303">      return null;</span>
    }
  }

  public Class getRowValueType(int row) {
<span class="nc" id="L308">    Gui4jCall value = mRowValue[row];</span>
<span class="nc bnc" id="L309" title="All 2 branches missed.">    if (value != null) {</span>
<span class="nc" id="L310">      return value.getResultClass();</span>
    }
<span class="nc" id="L312">    return null;</span>
  }

  public void setRow(
      int row,
      Gui4jCall rowValue,
      Gui4jCall rowName,
      Gui4jTextAttribute gui4jTextAttribute,
      int indentation) {
<span class="nc" id="L321">    mRowValue[row] = rowValue;</span>
<span class="nc" id="L322">    mRowName[row] = rowName;</span>
<span class="nc" id="L323">    mRowTextAttribute[row] = gui4jTextAttribute;</span>
<span class="nc" id="L324">    mRowIndentation[row] = StringUtil.copy(' ', indentation);</span>
<span class="nc" id="L325">  }</span>

  public void setRefresh(Gui4jCall[] refresh) {
<span class="nc" id="L328">    mRefresh = refresh;</span>
<span class="nc" id="L329">  }</span>

  /**
   * Sets the onSetValue.
   *
   * @param onSetValue The onSetValue to set
   */
  public void setOnSetValue(Gui4jCall onSetValue) {
<span class="nc" id="L337">    mOnSetValue = onSetValue;</span>
<span class="nc" id="L338">  }</span>

  public boolean isDefined(int row, int col) {
<span class="nc bnc" id="L341" title="All 4 branches missed.">    assert row &gt;= 0 &amp;&amp; row &lt; mRows;</span>
<span class="nc bnc" id="L342" title="All 4 branches missed.">    assert col &gt;= 0 &amp;&amp; col &lt; mCols;</span>
<span class="nc bnc" id="L343" title="All 2 branches missed.">    return mCell[row][col] != null;</span>
  }

  protected void setCell(int row, int col, Gui4jCell cell) {
<span class="nc bnc" id="L347" title="All 4 branches missed.">    assert row &gt;= 0 &amp;&amp; row &lt; mRows;</span>
<span class="nc bnc" id="L348" title="All 4 branches missed.">    assert col &gt;= 0 &amp;&amp; col &lt; mCols;</span>
<span class="nc bnc" id="L349" title="All 2 branches missed.">    assert mCell[row][col] == null;</span>
<span class="nc" id="L350">    mCell[row][col] = cell;</span>
<span class="nc" id="L351">  }</span>

  /**
   * Sets the reorderingAllowed.
   *
   * @param reorderingAllowed The reorderingAllowed to set
   */
  public void setReorderingAllowed(boolean reorderingAllowed) {
<span class="nc" id="L359">    mReorderingAllowed = reorderingAllowed;</span>
<span class="nc" id="L360">  }</span>

  /**
   * Sets the colSelectionMode.
   *
   * @param colSelectionMode The colSelectionMode to set
   */
  public void setColSelectionMode(int colSelectionMode) {
<span class="nc" id="L368">    mColSelectionMode = colSelectionMode;</span>
<span class="nc" id="L369">  }</span>

  /**
   * Sets the rowSelectionMode.
   *
   * @param rowSelectionMode The rowSelectionMode to set
   */
  public void setRowSelectionMode(int rowSelectionMode) {
<span class="nc" id="L377">    mRowSelectionMode = rowSelectionMode;</span>
<span class="nc" id="L378">  }</span>

  /**
   * Sets the rowSelectionAllowed.
   *
   * @param rowSelectionAllowed The rowSelectionAllowed to set
   */
  public void setRowSelectionAllowed(boolean rowSelectionAllowed) {
<span class="nc" id="L386">    mRowSelectionAllowed = rowSelectionAllowed;</span>
<span class="nc" id="L387">  }</span>

  protected Point getPopupLocation(
      Gui4jComponentInstance gui4jComponentInstance, MouseEvent mouseEvent, Object context) {
<span class="nc bnc" id="L391" title="All 2 branches missed.">    if (mouseEvent != null) {</span>
<span class="nc" id="L392">      return mouseEvent.getPoint();</span>
    }

<span class="nc" id="L395">    JTable table = (JTable) gui4jComponentInstance.getComponent();</span>
<span class="nc" id="L396">    Rectangle selection =</span>
<span class="nc" id="L397">        table.getCellRect(table.getSelectedRow(), table.getSelectedColumn(), true);</span>
<span class="nc" id="L398">    return new Point(selection.x + selection.width / 2, selection.y + selection.height / 2);</span>
  }

  /**
   * @see org.gui4j.core.Gui4jComponent#refreshComponent(Gui4jComponentInstance)
   */
  public void refreshComponent(Gui4jComponentInstance gui4jComponentInstance) {
<span class="nc" id="L405">    super.refreshComponent(gui4jComponentInstance);</span>
<span class="nc" id="L406">    Gui4jJTable table = (Gui4jJTable) gui4jComponentInstance.getComponent();</span>
<span class="nc" id="L407">    Gui4jTableModel model = (Gui4jTableModel) table.getModel();</span>
<span class="nc" id="L408">    model.eventOccured();</span>
<span class="nc" id="L409">  }</span>

  /**
   * @see org.gui4j.core.Gui4jComponent#dispose(Gui4jComponentInstance)
   */
  public void dispose(Gui4jComponentInstance gui4jComponentInstance) {
<span class="nc" id="L415">    super.dispose(gui4jComponentInstance);</span>
<span class="nc" id="L416">    Gui4jJTable jTable = (Gui4jJTable) gui4jComponentInstance.getSwingComponent();</span>
<span class="nc bnc" id="L417" title="All 2 branches missed.">    if (jTable != null) {</span>
<span class="nc" id="L418">      Gui4jTableModel model = (Gui4jTableModel) jTable.getModel();</span>
<span class="nc" id="L419">      model.dispose();</span>
    }
<span class="nc" id="L421">  }</span>

  // ***************************************************************************************

  public class Gui4jColumnTable implements Serializable {
    private static final long serialVersionUID = 1L;
    private final Gui4jCall mEnabled;
    protected final Gui4jCall mColumnName;
    protected final Gui4jCall mColumnValue;
    private final Gui4jTextAttribute mGui4jTextAttribute;

<span class="nc" id="L432">    private double mWeight = 1.0;</span>

    public Gui4jColumnTable(
        int col,
        Gui4jCall columnName,
        Gui4jCall columnValue,
        Gui4jTextAttribute gui4jTextAttribute,
<span class="nc" id="L439">        Gui4jCall enabled) {</span>
<span class="nc" id="L440">      mColumnName = columnName;</span>
<span class="nc" id="L441">      mColumnValue = columnValue;</span>
<span class="nc" id="L442">      mEnabled = enabled;</span>
<span class="nc" id="L443">      mGui4jTextAttribute = gui4jTextAttribute;</span>
<span class="nc" id="L444">      setColumn(col, this);</span>
<span class="nc" id="L445">    }</span>

    public String getName(Gui4jCallBase gui4jController) {
<span class="nc bnc" id="L448" title="All 2 branches missed.">      if (mColumnName != null) {</span>
<span class="nc" id="L449">        Map m = null;</span>
<span class="nc bnc" id="L450" title="All 2 branches missed.">        if (mColumnValue != null) {</span>
<span class="nc" id="L451">          Map nullMap = null;</span>
<span class="nc" id="L452">          m = new Gui4jMap1(PARAM_COLVALUE, mColumnValue.getValue(gui4jController, nullMap, null));</span>
        }
<span class="nc" id="L454">        return (String) mColumnName.getValue(gui4jController, m, null);</span>
      } else {
<span class="nc" id="L456">        return &quot;&quot;;</span>
      }
    }

    public boolean isEnabled(Gui4jCallBase gui4jController) {
<span class="nc" id="L461">      Map m = null;</span>
<span class="nc bnc" id="L462" title="All 4 branches missed.">      return mEnabled == null || !Boolean.FALSE.equals(mEnabled.getValue(gui4jController, m, null));</span>
    }

    public Class getColumnClass() {
<span class="nc bnc" id="L466" title="All 2 branches missed.">      if (mColumnValue != null) {</span>
<span class="nc" id="L467">        return mColumnValue.getResultClass();</span>
      } else {
<span class="nc" id="L469">        return Object.class;</span>
      }
    }

    public void setColumnAttributes(TableColumn tableColumn) {
      // currently empty
<span class="nc" id="L475">    }</span>

    /**
     * Returns the weight.
     *
     * @return double
     */
    public double getWeight() {
<span class="nc" id="L483">      return mWeight;</span>
    }

    /**
     * Sets the weight.
     *
     * @param weight The weight to set
     */
    public void setWeight(double weight) {
<span class="nc" id="L492">      mWeight = weight;</span>
<span class="nc" id="L493">    }</span>

    /**
     * Returns the gui4jTextAttribute.
     *
     * @return Gui4jTextAttribute
     */
    public Gui4jTextAttribute getGui4jTextAttribute() {
<span class="nc" id="L501">      return mGui4jTextAttribute;</span>
    }
  }

  public interface Enabled {
    boolean isEnabled(int row, int column);
  }

  public final class CellRenderer extends DefaultTableCellRenderer {
    private final Color mDefaultForeground;
    private final Color mDefaultBackground;
    private final Font mDefaultFont;

    private final Color[][] mForeground;
    private final Color[][] mBackground;
    private final Font[][] mFont;
    private final int[][] mAlignment;
    private final TableCellRenderer booleanCellRenderer;
    private Enabled mEnabledInstance;

    public CellRenderer(
<span class="nc" id="L522">        Gui4jComponentInstance gui4jComponentInstance, Gui4jJTable table, Enabled enabledInstance) {</span>
<span class="nc" id="L523">      mEnabledInstance = enabledInstance;</span>
<span class="nc" id="L524">      Gui4jCallBase gui4jController = gui4jComponentInstance.getGui4jCallBase();</span>
<span class="nc" id="L525">      mDefaultBackground = getBackground();</span>
<span class="nc" id="L526">      mDefaultForeground = getForeground();</span>
<span class="nc" id="L527">      mDefaultFont = getFont();</span>

<span class="nc" id="L529">      mForeground = new Color[mRows][mCols];</span>
<span class="nc" id="L530">      mBackground = new Color[mRows][mCols];</span>
<span class="nc" id="L531">      mAlignment = new int[mRows][mCols];</span>
<span class="nc" id="L532">      mFont = new Font[mRows][mCols];</span>

<span class="nc" id="L534">      booleanCellRenderer = new BooleanTableCellRenderer(noFocusBorder);</span>

<span class="nc" id="L536">      Gui4jTextAttribute[] columnTextAttribute = new Gui4jTextAttribute[mCols];</span>
<span class="nc bnc" id="L537" title="All 2 branches missed.">      for (int col = 0; col &lt; mCols; col++) {</span>
<span class="nc" id="L538">        Gui4jColumnTable tableColumn = mColumn[col];</span>
<span class="nc bnc" id="L539" title="All 2 branches missed.">        if (tableColumn != null) {</span>
<span class="nc" id="L540">          columnTextAttribute[col] = tableColumn.getGui4jTextAttribute();</span>
        }
      }

<span class="nc bnc" id="L544" title="All 2 branches missed.">      for (int row = 0; row &lt; mRows; row++) {</span>
<span class="nc bnc" id="L545" title="All 2 branches missed.">        for (int col = 0; col &lt; mCols; col++) {</span>
<span class="nc" id="L546">          Gui4jTextAttribute cellTextAttribute = null;</span>
<span class="nc" id="L547">          Gui4jCell cell = mCell[row][col];</span>
<span class="nc bnc" id="L548" title="All 2 branches missed.">          if (cell != null) {</span>
<span class="nc" id="L549">            cellTextAttribute = cell.getGui4jTextAttribute();</span>
          }
<span class="nc" id="L551">          mForeground[row][col] =</span>
<span class="nc" id="L552">              Gui4jTextAttribute.getForeground(</span>
                  gui4jController,
                  cellTextAttribute,
                  columnTextAttribute[col],
                  mRowTextAttribute[row]);
<span class="nc" id="L557">          mBackground[row][col] =</span>
<span class="nc" id="L558">              Gui4jTextAttribute.getBackground(</span>
                  gui4jController,
                  cellTextAttribute,
                  columnTextAttribute[col],
                  mRowTextAttribute[row]);
<span class="nc" id="L563">          mFont[row][col] =</span>
<span class="nc" id="L564">              Gui4jTextAttribute.getFont(</span>
                  gui4jController,
                  cellTextAttribute,
                  columnTextAttribute[col],
                  mRowTextAttribute[row]);
<span class="nc" id="L569">          mAlignment[row][col] =</span>
<span class="nc" id="L570">              Gui4jTextAttribute.getAlignment(</span>
                  cellTextAttribute, columnTextAttribute[col], mRowTextAttribute[row]);
        }
      }
<span class="nc" id="L574">    }</span>

    public Component getTableCellRendererComponent(
        JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column) {
<span class="nc" id="L578">      setForeground(mDefaultForeground);</span>
<span class="nc" id="L579">      setBackground(mDefaultBackground);</span>
<span class="nc" id="L580">      setFont(mDefaultFont);</span>
<span class="nc" id="L581">      setEnabled(mEnabledInstance.isEnabled(row, column));</span>

      JComponent c;
<span class="nc bnc" id="L584" title="All 6 branches missed.">      if ((value != null &amp;&amp; value.getClass() == Boolean.class)</span>
<span class="nc bnc" id="L585" title="All 2 branches missed.">          || (value == null &amp;&amp; table.getColumnClass(column).equals(Boolean.class))) {</span>
<span class="nc" id="L586">        c =</span>
            (JComponent)
<span class="nc" id="L588">                booleanCellRenderer.getTableCellRendererComponent(</span>
                    table, value, isSelected, hasFocus, row, column);
      } else {
<span class="nc" id="L591">        c =</span>
            (JComponent)
<span class="nc" id="L593">                super.getTableCellRendererComponent(</span>
                    table, value, isSelected, hasFocus, row, column);
      }

<span class="nc bnc" id="L597" title="All 2 branches missed.">      if (!isSelected) {</span>
<span class="nc" id="L598">        Color foreground = mForeground[row][column];</span>
<span class="nc bnc" id="L599" title="All 2 branches missed.">        if (foreground != null) {</span>
<span class="nc" id="L600">          c.setForeground(foreground);</span>
        }
<span class="nc" id="L602">        Color background = mBackground[row][column];</span>
<span class="nc bnc" id="L603" title="All 2 branches missed.">        if (background != null) {</span>
<span class="nc" id="L604">          c.setBackground(background);</span>
        }
      }
<span class="nc" id="L607">      Font font = mFont[row][column];</span>
<span class="nc bnc" id="L608" title="All 2 branches missed.">      if (font != null) {</span>
<span class="nc" id="L609">        c.setFont(font);</span>
      }
<span class="nc bnc" id="L611" title="All 2 branches missed.">      if (c instanceof JLabel) {</span>
<span class="nc" id="L612">        JLabel l = (JLabel) c;</span>
<span class="nc" id="L613">        l.setHorizontalAlignment(mAlignment[row][column]);</span>
      }
<span class="nc" id="L615">      return c;</span>
    }
  }

  public final class Gui4jCell implements Serializable {
    private static final long serialVersionUID = 1L;
    private final Gui4jCall mGetValue;
    private final Gui4jCall mSetValue;
    private final Gui4jCall mEnabled;
    private final int mCol;
    private final int mRow;
    private final Gui4jTextAttribute mGui4jTextAttribute;
    private final Gui4jCall mList;
    private final Gui4jCall mListItem;
    private final Gui4jCall mListNullItem;
    private final Gui4jCall mListEditable;
    private final Gui4jCall mStringConvert;

    public Gui4jCell(
        Gui4jCall getValue,
        Gui4jCall setValue,
        Gui4jCall enabled,
        Gui4jCall list,
        Gui4jCall listItem,
        Gui4jCall listNullItem,
        Gui4jCall listEditable,
        Gui4jCall stringConvert,
        int row,
        int col,
<span class="nc" id="L644">        Gui4jTextAttribute gui4jTextAttribute) {</span>
<span class="nc" id="L645">      mGetValue = getValue;</span>
<span class="nc" id="L646">      mSetValue = setValue;</span>
<span class="nc" id="L647">      mEnabled = enabled;</span>
<span class="nc" id="L648">      mCol = col;</span>
<span class="nc" id="L649">      mRow = row;</span>
<span class="nc" id="L650">      mGui4jTextAttribute = gui4jTextAttribute;</span>
<span class="nc" id="L651">      mList = list;</span>
<span class="nc" id="L652">      mListItem = listItem;</span>
<span class="nc" id="L653">      mListNullItem = listNullItem;</span>
<span class="nc" id="L654">      mListEditable = listEditable;</span>
<span class="nc" id="L655">      mStringConvert = stringConvert;</span>
<span class="nc" id="L656">      setCell(row, col, this);</span>
<span class="nc" id="L657">    }</span>

    protected void prepareEditor(Gui4jCallBase gui4jController, TableCellEditor editor) {
<span class="nc bnc" id="L660" title="All 2 branches missed.">      if (mList != null) {</span>
<span class="nc" id="L661">        ComboBoxCellEdit edit = (ComboBoxCellEdit) editor;</span>
<span class="nc" id="L662">        Map m = getParamMap(gui4jController, true);</span>
<span class="nc" id="L663">        edit.setParamMap(m);</span>
<span class="nc" id="L664">        String nullItemText = null;</span>
<span class="nc bnc" id="L665" title="All 2 branches missed.">        if (mListNullItem != null) {</span>
<span class="nc" id="L666">          nullItemText = (String) mListNullItem.getValueNoParams(gui4jController, &quot;(undefined)&quot;);</span>
<span class="nc bnc" id="L667" title="All 4 branches missed.">          if (nullItemText == null || nullItemText.length() == 0) {</span>
<span class="nc" id="L668">            nullItemText = &quot; &quot;; // combobox can't deal correctly</span>
            // with null elements and empty
            // strings
          }
        }
<span class="nc" id="L673">        edit.setContent((Collection) m.get(PARAM_LIST), nullItemText);</span>
<span class="nc" id="L674">        edit.setSelectedItem(m.get(PARAM_LIST_ITEM));</span>
      }
<span class="nc" id="L676">    }</span>

    protected TableCellEditor getCellEditor(
        Gui4jCallBase gui4jController, Font font, TableCellEditor editor) {
<span class="nc bnc" id="L680" title="All 2 branches missed.">      if (mList != null) {</span>
<span class="nc bnc" id="L681" title="All 4 branches missed.">        if (mGui4jTextAttribute != null &amp;&amp; mGui4jTextAttribute.getFont() != null) {</span>
<span class="nc" id="L682">          font = (Font) mGui4jTextAttribute.getFont().getValueNoParams(gui4jController, font);</span>
        }
<span class="nc" id="L684">        ComboBoxCellEdit edit =</span>
<span class="nc" id="L685">            ComboBoxCellEdit.getInstance(</span>
                gui4jController, mGetValue, mStringConvert, PARAM_LIST_ITEM, font);
<span class="nc" id="L687">        edit.setParamMap(getParamMap(gui4jController, true));</span>
<span class="nc bnc" id="L688" title="All 2 branches missed.">        if (mListEditable != null) {</span>
<span class="nc" id="L689">          Boolean editable = (Boolean) mListEditable.getValueNoParams(gui4jController, null);</span>
<span class="nc" id="L690">          edit.setEditable(Boolean.TRUE.equals(editable));</span>
        }

<span class="nc" id="L693">        return edit;</span>
      } else {
<span class="nc" id="L695">        return editor;</span>
      }
    }

    boolean hasSetter(Gui4jCallBase gui4jController) {
<span class="nc bnc" id="L700" title="All 4 branches missed.">      return mSetValue != null &amp;&amp; isEnabled(gui4jController);</span>
    }

    private Map getParamMap(Gui4jCallBase gui4jController, boolean includeListItem) {
<span class="nc" id="L704">      Map m = new HashMap();</span>
<span class="nc" id="L705">      m.put(PARAM_COL, Integer.valueOf(mCol));</span>
<span class="nc" id="L706">      m.put(PARAM_ROW, Integer.valueOf(mRow));</span>

<span class="nc" id="L708">      Gui4jCall columnValue = null;</span>
<span class="nc bnc" id="L709" title="All 2 branches missed.">      if (mColumn[mCol] != null) {</span>
<span class="nc" id="L710">        columnValue = mColumn[mCol].mColumnValue;</span>
      }
<span class="nc" id="L712">      Gui4jCall rowValue = mRowValue[mRow];</span>
<span class="nc bnc" id="L713" title="All 2 branches missed.">      if (columnValue != null) {</span>
<span class="nc" id="L714">        Map nullMap = null;</span>
<span class="nc" id="L715">        m.put(PARAM_COLVALUE, columnValue.getValue(gui4jController, nullMap, null));</span>
      }
<span class="nc bnc" id="L717" title="All 2 branches missed.">      if (rowValue != null) {</span>
<span class="nc" id="L718">        Map nullMap = null;</span>
<span class="nc" id="L719">        m.put(PARAM_ROWVALUE, rowValue.getValue(gui4jController, nullMap, null));</span>
      }

<span class="nc bnc" id="L722" title="All 2 branches missed.">      if (mList != null) {</span>
<span class="nc" id="L723">        Collection collection = (Collection) mList.getValue(gui4jController, m, null);</span>
<span class="nc" id="L724">        m.put(PARAM_LIST, collection);</span>
<span class="nc bnc" id="L725" title="All 4 branches missed.">        if (includeListItem &amp;&amp; mListItem != null) {</span>
<span class="nc" id="L726">          Object listItem = mListItem.getValue(gui4jController, m, null);</span>
<span class="nc" id="L727">          m.put(PARAM_LIST_ITEM, listItem);</span>
        }
      }

<span class="nc" id="L731">      return m;</span>
    }

    boolean isEnabled(Gui4jCallBase gui4jController) {
<span class="nc bnc" id="L735" title="All 4 branches missed.">      boolean columnEnabled = mColumn[mCol] == null || mColumn[mCol].isEnabled(gui4jController);</span>
<span class="nc bnc" id="L736" title="All 2 branches missed.">      if (columnEnabled) {</span>
<span class="nc bnc" id="L737" title="All 2 branches missed.">        if (mEnabled != null) {</span>
<span class="nc" id="L738">          Map m = getParamMap(gui4jController, true);</span>

<span class="nc" id="L740">          Boolean enabled = (Boolean) mEnabled.getValue(gui4jController, m, Boolean.TRUE);</span>
<span class="nc bnc" id="L741" title="All 2 branches missed.">          if (enabled != null) {</span>
<span class="nc" id="L742">            return enabled.booleanValue();</span>
          } else {
<span class="nc" id="L744">            return false;</span>
          }
        } else {
<span class="nc" id="L747">          return true;</span>
        }
      } else {
<span class="nc" id="L750">        return false;</span>
      }
    }

    Object getValue(Gui4jCallBase gui4jController) {
<span class="nc bnc" id="L755" title="All 2 branches missed.">      if (mGetValue != null) {</span>
<span class="nc" id="L756">        Map m = getParamMap(gui4jController, true);</span>
<span class="nc" id="L757">        return mGetValue.getValue(gui4jController, m, null);</span>
      } else {
<span class="nc" id="L759">        return null;</span>
      }
    }

    void setValue(Gui4jCallBase gui4jController, Object value, Gui4jTableModel model) {
<span class="nc bnc" id="L764" title="All 2 branches missed.">      if (mSetValue != null) {</span>
<span class="nc" id="L765">        Map paramMap = getParamMap(gui4jController, false);</span>

<span class="nc bnc" id="L767" title="All 2 branches missed.">        if (value instanceof ComboBoxNullItem) {</span>
<span class="nc" id="L768">          value = null;</span>
        }

<span class="nc" id="L771">        paramMap.put(PARAM_VALUE, value);</span>

        Gui4jGetValue[] work;
<span class="nc bnc" id="L774" title="All 2 branches missed.">        if (mOnSetValue != null) {</span>
<span class="nc" id="L775">          work =</span>
              new Gui4jGetValue[] {
                mSetValue,
                new Gui4jRefreshTable(model, mRow, mCol),
<span class="nc" id="L779">                model.getAutomaticRefresh(),</span>
                mOnSetValue
              };
        } else {
<span class="nc" id="L783">          work =</span>
              new Gui4jGetValue[] {
<span class="nc" id="L785">                mSetValue, new Gui4jRefreshTable(model, mRow, mCol), model.getAutomaticRefresh()</span>
              };
        }
<span class="nc" id="L788">        mGui4jThreadManager.performWork(gui4jController, work, paramMap);</span>
      }
<span class="nc" id="L790">    }</span>

    Class getCellClass() {
<span class="nc bnc" id="L793" title="All 2 branches missed.">      if (mGetValue != null) {</span>
<span class="nc" id="L794">        return mGetValue.getResultClass();</span>
      } else {
<span class="nc" id="L796">        return Object.class;</span>
      }
    }

    /**
     * Returns the gui4jTextAttribute.
     *
     * @return Gui4jTextAttribute
     */
    public Gui4jTextAttribute getGui4jTextAttribute() {
<span class="nc" id="L806">      return mGui4jTextAttribute;</span>
    }
  }

  public class Gui4jTableModel extends RowHeaderAbstractTableModel
      implements Gui4jEventListener, Enabled, Gui4jTableListener {

    private Gui4jSwingContainer mGui4jSwingContainer;
    private Gui4jCallBase mGui4jController;
    private Gui4jComponentInstance mGui4jComponentInstance;

<span class="nc" id="L817">    public Gui4jTableModel(Gui4jSwingContainer gui4jSwingContainer, Gui4jCallBase gui4jCallBase) {</span>
<span class="nc" id="L818">      mGui4jSwingContainer = gui4jSwingContainer;</span>
<span class="nc" id="L819">      mGui4jController = gui4jCallBase;</span>
<span class="nc" id="L820">    }</span>

    public void eventOccured() {
<span class="nc" id="L823">      Runnable run =</span>
<span class="nc" id="L824">          new Runnable() {</span>
            public void run() {
<span class="nc" id="L826">              fireTableRowsUpdated(0, getRowCount() - 1);</span>
<span class="nc" id="L827">            }</span>
          };
<span class="nc" id="L829">      Gui4jThreadManager.executeInSwingThreadAndWait(run);</span>
<span class="nc" id="L830">    }</span>

    public Gui4jGetValue getAutomaticRefresh() {
<span class="nc" id="L833">      Gui4jJTable table = (Gui4jJTable) mGui4jComponentInstance.getSwingComponent();</span>
<span class="nc bnc" id="L834" title="All 4 branches missed.">      if (mAutomaticRefresh &amp;&amp; table != null) {</span>
<span class="nc" id="L835">        return table.getAutomaticRefreshAction();</span>
      } else {
<span class="nc" id="L837">        return null;</span>
      }
    }

    public int getColumnCount() {
<span class="nc" id="L842">      return mCols;</span>
    }

    public int getRowCount() {
<span class="nc" id="L846">      return mRows;</span>
    }

    public boolean isEnabled(int row, int column) {
<span class="nc bnc" id="L850" title="All 8 branches missed.">      if (row &gt;= 0 &amp;&amp; column &gt;= 0 &amp;&amp; row &lt; mRows &amp;&amp; column &lt; mCols) {</span>
<span class="nc" id="L851">        Gui4jCell cell = mCell[row][column];</span>
<span class="nc bnc" id="L852" title="All 2 branches missed.">        if (cell != null) {</span>
<span class="nc" id="L853">          return cell.isEnabled(mGui4jController);</span>
        } else {
<span class="nc" id="L855">          return true;</span>
        }
      } else {
<span class="nc" id="L858">        return true;</span>
      }
    }

    public String getRowName(int row) {
<span class="nc bnc" id="L863" title="All 2 branches missed.">      if (mRowName[row] != null) {</span>
<span class="nc" id="L864">        Map paramMap = new HashMap();</span>
<span class="nc" id="L865">        paramMap.put(PARAM_ROW, Integer.valueOf(row));</span>
<span class="nc bnc" id="L866" title="All 2 branches missed.">        if (mRowValue[row] != null) {</span>
<span class="nc" id="L867">          Map nullMap = null;</span>
<span class="nc" id="L868">          paramMap.put(PARAM_ROWVALUE, mRowValue[row].getValue(mGui4jController, nullMap, null));</span>
        }
<span class="nc" id="L870">        String name = (String) mRowName[row].getValue(mGui4jController, paramMap, null);</span>
<span class="nc bnc" id="L871" title="All 4 branches missed.">        if (name == null || name.equals(&quot;&quot;)) {</span>
<span class="nc" id="L872">          return mRowIndentation[row];</span>
        }
<span class="nc" id="L874">        return mRowIndentation[row] + name;</span>
      } else {
<span class="nc" id="L876">        mLogger.info(&quot;Zeilenname für Zeile &quot; + row + &quot; ist nicht definiert&quot;);</span>
<span class="nc" id="L877">        return &quot;&quot;;</span>
      }
    }

<span class="nc" id="L881">    public void setRowName(int row, String name) {}</span>

<span class="nc" id="L883">    public void setRowName(int row, Object name) {}</span>

    public boolean isCellEditable(int row, int col) {
<span class="nc bnc" id="L886" title="All 4 branches missed.">      if (handleReadOnly() &amp;&amp; mGui4jSwingContainer.inReadOnlyMode()) {</span>
<span class="nc" id="L887">        return false;</span>
      } else {

<span class="nc" id="L890">        Gui4jCell cell = mCell[row][col];</span>
<span class="nc bnc" id="L891" title="All 2 branches missed.">        if (cell != null) {</span>
<span class="nc" id="L892">          return cell.hasSetter(mGui4jController);</span>
        } else {
<span class="nc" id="L894">          return false;</span>
        }
      }
    }

    public Object getValueAt(int row, int col) {
<span class="nc" id="L900">      Gui4jCell cell = mCell[row][col];</span>
<span class="nc bnc" id="L901" title="All 2 branches missed.">      if (cell != null) {</span>
<span class="nc" id="L902">        return cell.getValue(mGui4jController);</span>
      } else {
<span class="nc" id="L904">        return null;</span>
      }
    }

    public void setValueAt(Object value, int row, int col) {
<span class="nc" id="L909">      Gui4jCell cell = mCell[row][col];</span>
<span class="nc bnc" id="L910" title="All 2 branches missed.">      if (cell != null) {</span>
<span class="nc" id="L911">        cell.setValue(mGui4jController, value, this);</span>
      }
<span class="nc" id="L913">    }</span>

    public Class getColumnClass(int columnIndex) {
<span class="nc" id="L916">      Class commonClass = null;</span>
<span class="nc" id="L917">      boolean different = false;</span>
<span class="nc bnc" id="L918" title="All 2 branches missed.">      for (int r = 0; r &lt; mRows; r++) {</span>
<span class="nc" id="L919">        Gui4jCell cell = mCell[r][columnIndex];</span>
<span class="nc bnc" id="L920" title="All 2 branches missed.">        if (cell != null) {</span>
<span class="nc" id="L921">          Class c = cell.getCellClass();</span>
<span class="nc bnc" id="L922" title="All 2 branches missed.">          if (commonClass == null) {</span>
<span class="nc" id="L923">            commonClass = c;</span>
          } else {
<span class="nc bnc" id="L925" title="All 2 branches missed.">            different |= commonClass != c;</span>
          }
        }
      }
<span class="nc bnc" id="L929" title="All 4 branches missed.">      if (commonClass != null &amp;&amp; !different) {</span>
<span class="nc" id="L930">        return commonClass;</span>
      } else {
<span class="nc" id="L932">        return Object.class;</span>
      }
    }

    public String getColumnName(int columnIndex) {
<span class="nc bnc" id="L937" title="All 2 branches missed.">      if (mColumn[columnIndex] != null) {</span>
<span class="nc" id="L938">        String name = mColumn[columnIndex].getName(mGui4jController);</span>
<span class="nc bnc" id="L939" title="All 4 branches missed.">        if (name == null || name.equals(&quot;&quot;)) {</span>
<span class="nc" id="L940">          return &quot; &quot;;</span>
        }
<span class="nc" id="L942">        return name;</span>
      } else {
<span class="nc" id="L944">        mLogger.info(</span>
<span class="nc" id="L945">            getId()</span>
                + &quot;: Spaltenname für Spalte &quot;
                + columnIndex
                + &quot; ist nicht definiert in XML Datei: &quot;
<span class="nc" id="L949">                + getConfigurationName());</span>
<span class="nc" id="L950">        return &quot; &quot;;</span>
      }
    }

    public void setGui4jComponentInstance(Gui4jComponentInstance gui4jComponentInstance) {
<span class="nc" id="L955">      mGui4jComponentInstance = gui4jComponentInstance;</span>
<span class="nc" id="L956">    }</span>

    /**
     * @see org.gui4j.core.swing.Gui4jTableListener#prepareEditor(TableCellEditor, int, int)
     */
    public void prepareEditor(TableCellEditor editor, int row, int column) {
<span class="nc" id="L962">      Gui4jCell cell = mCell[row][column];</span>
<span class="nc bnc" id="L963" title="All 2 branches missed.">      if (cell != null) {</span>
<span class="nc" id="L964">        cell.prepareEditor(mGui4jController, editor);</span>
      }
<span class="nc" id="L966">    }</span>

    /**
     * @see org.gui4j.core.swing.Gui4jTableListener#getCellEditor(TableCellEditor, int, int)
     */
    public TableCellEditor getCellEditor(TableCellEditor editor, int row, int column) {
<span class="nc" id="L972">      Gui4jCell cell = mCell[row][column];</span>
<span class="nc bnc" id="L973" title="All 2 branches missed.">      return cell == null</span>
<span class="nc" id="L974">          ? editor</span>
<span class="nc" id="L975">          : cell.getCellEditor(</span>
<span class="nc" id="L976">              mGui4jController, mGui4jComponentInstance.getSwingComponent().getFont(), editor);</span>
    }

    /**
     * @see org.gui4j.core.swing.Gui4jTableListener#getCellRenderer(TableCellRenderer, int, int)
     */
    public TableCellRenderer getCellRenderer(TableCellRenderer renderer, int row, int column) {
<span class="nc" id="L983">      return renderer;</span>
    }

    public void dispose() {
<span class="nc" id="L987">      mGui4jSwingContainer = null;</span>
<span class="nc" id="L988">      mGui4jController = null;</span>
<span class="nc" id="L989">      mGui4jComponentInstance = null;</span>
<span class="nc" id="L990">    }</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>