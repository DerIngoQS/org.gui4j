<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Gui4jJComponent.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">gui4j</a> &gt; <a href="index.source.html" class="el_package">org.gui4j.component</a> &gt; <span class="el_source">Gui4jJComponent.java</span></div><h1>Gui4jJComponent.java</h1><pre class="source lang-java linenums">package org.gui4j.component;

import java.awt.KeyboardFocusManager;
import java.lang.reflect.InvocationTargetException;
import java.util.Map;
import java.util.Set;
import javax.swing.JComponent;
import javax.swing.border.Border;
import org.gui4j.Gui4jCallBase;
import org.gui4j.core.Gui4jCall;
import org.gui4j.core.Gui4jComponentContainer;
import org.gui4j.core.Gui4jComponentFactory;
import org.gui4j.core.Gui4jComponentInstance;
import org.gui4j.core.Gui4jMap1;
import org.gui4j.core.Gui4jQualifiedComponent;
import org.gui4j.core.Gui4jSwingContainer;
import org.gui4j.event.Gui4jEventListener;
import org.gui4j.exception.ErrorTags;
import org.gui4j.exception.Gui4jUncheckedException;

public abstract class Gui4jJComponent extends Gui4jAbstractPopupComponent implements ErrorTags {

  protected Gui4jCall mGrabFocus;
  private boolean mHandleReadOnly;
  private String mKeyMapId;
  private Set mFocusTraversalKeysForward;
  private Set mFocusTraversalKeysBackward;

  public Gui4jJComponent(
      Gui4jComponentContainer gui4jComponentContainer, Class swingClass, String id) {
<span class="nc" id="L31">    super(gui4jComponentContainer, swingClass, id);</span>
<span class="nc" id="L32">  }</span>

  protected void setProperties(final Gui4jComponentInstance gui4jComponentInstance) {
<span class="nc" id="L35">    super.setProperties(gui4jComponentInstance);</span>

<span class="nc" id="L37">    final JComponent component = gui4jComponentInstance.getSwingComponent();</span>

<span class="nc bnc" id="L39" title="All 2 branches missed.">    if (mKeyMapId != null) {</span>
<span class="nc" id="L40">      Gui4jQualifiedComponent gui4jComponentInPath =</span>
          gui4jComponentInstance
<span class="nc" id="L42">              .getGui4jComponent()</span>
<span class="nc" id="L43">              .getGui4jComponentContainer()</span>
<span class="nc" id="L44">              .getGui4jQualifiedComponent(mKeyMapId);</span>
<span class="nc" id="L45">      Gui4jComponentInstance keyMapInstance =</span>
<span class="nc" id="L46">          gui4jComponentInstance.getGui4jComponentInstance(gui4jComponentInPath);</span>
<span class="nc" id="L47">      Gui4jKeyMap.applyDefinitions(keyMapInstance, component);</span>
    }

<span class="nc bnc" id="L50" title="All 2 branches missed.">    if (mGrabFocus != null) {</span>
<span class="nc" id="L51">      Gui4jEventListener eventListener =</span>
<span class="nc" id="L52">          new Gui4jEventListener() {</span>
            public void eventOccured() {
<span class="nc" id="L54">              Boolean b = Boolean.TRUE;</span>
<span class="nc bnc" id="L55" title="All 2 branches missed.">              if (mGrabFocus.getResultClass() != null) {</span>
<span class="nc" id="L56">                Map m =</span>
                    new Gui4jMap1(
<span class="nc" id="L58">                        Gui4jComponentFactory.CONTEXT, gui4jComponentInstance.getContext());</span>
<span class="nc" id="L59">                b =</span>
                    (Boolean)
<span class="nc" id="L61">                        mGrabFocus.getValue(gui4jComponentInstance.getGui4jCallBase(), m, null);</span>
              }
<span class="nc bnc" id="L63" title="All 2 branches missed.">              if (Boolean.TRUE.equals(b)) {</span>
<span class="nc" id="L64">                JComponent jComponent = gui4jComponentInstance.getSwingComponent();</span>
<span class="nc" id="L65">                jComponent.grabFocus();</span>
              }
<span class="nc" id="L67">            }</span>
          };
<span class="nc" id="L69">      registerEvents(</span>
<span class="nc" id="L70">          gui4jComponentInstance.getGui4jSwingContainer(),</span>
<span class="nc" id="L71">          gui4jComponentInstance.getGui4jCallBase(),</span>
<span class="nc" id="L72">          mGrabFocus.getDependantProperties(),</span>
          eventListener);
    }

<span class="nc bnc" id="L76" title="All 2 branches missed.">    if (mFocusTraversalKeysForward != null) {</span>
<span class="nc" id="L77">      component.setFocusTraversalKeys(</span>
          KeyboardFocusManager.FORWARD_TRAVERSAL_KEYS, mFocusTraversalKeysForward);
    }

<span class="nc bnc" id="L81" title="All 2 branches missed.">    if (mFocusTraversalKeysBackward != null) {</span>
<span class="nc" id="L82">      component.setFocusTraversalKeys(</span>
          KeyboardFocusManager.BACKWARD_TRAVERSAL_KEYS, mFocusTraversalKeysBackward);
    }
<span class="nc" id="L85">  }</span>

  protected boolean handleReadOnly() {
<span class="nc" id="L88">    return mHandleReadOnly;</span>
  }

  protected Gui4jComponentInstance createComponentInstance(
      Gui4jSwingContainer gui4jSwingContainer,
      Gui4jCallBase gui4jCallBase,
      Gui4jQualifiedComponent gui4jComponentInPath) {
    try {
<span class="nc" id="L96">      JComponent jComponent =</span>
<span class="nc" id="L97">          (JComponent) getComponentClass().getDeclaredConstructor().newInstance();</span>
<span class="nc" id="L98">      Gui4jComponentInstance gui4jComponentInstance =</span>
          new Gui4jComponentInstance(gui4jSwingContainer, jComponent, gui4jComponentInPath);
<span class="nc" id="L100">      return gui4jComponentInstance;</span>
<span class="nc" id="L101">    } catch (IllegalAccessException e) {</span>
<span class="nc" id="L102">      throw new Gui4jUncheckedException.ProgrammingError(</span>
          PROGRAMMING_ERROR_illegal_access_exception, e);
<span class="nc" id="L104">    } catch (InstantiationException e) {</span>
<span class="nc" id="L105">      throw new Gui4jUncheckedException.ProgrammingError(</span>
          PROGRAMMING_ERROR_instantiation_exception, e);
<span class="nc" id="L107">    } catch (NoSuchMethodException e) {</span>
<span class="nc" id="L108">      throw new Gui4jUncheckedException.ProgrammingError(</span>
          PROGRAMMING_ERROR_instantiation_exception, e);
<span class="nc" id="L110">    } catch (InvocationTargetException e) {</span>
<span class="nc" id="L111">      throw new Gui4jUncheckedException.ProgrammingError(</span>
          PROGRAMMING_ERROR_instantiation_exception, e);
    }
  }

  public void setHandleReadOnly(boolean handleReadOnly) {
<span class="nc" id="L117">    mHandleReadOnly = handleReadOnly;</span>
<span class="nc" id="L118">  }</span>

  public void setKeyMapId(String id) {
<span class="nc" id="L121">    mKeyMapId = id;</span>
<span class="nc" id="L122">  }</span>

  /**
   * Sets the border.
   *
   * @param jComponent
   * @param border The border to set
   */
  public void setBorder(JComponent jComponent, Border border) {
<span class="nc" id="L131">    jComponent.setBorder(border);</span>
<span class="nc" id="L132">  }</span>

  /**
   * Sets the tooltip.
   *
   * @param jComponent
   * @param text The tooltip to set
   */
  public void setTooltip(JComponent jComponent, String text) {
<span class="nc" id="L141">    jComponent.setToolTipText(text);</span>
<span class="nc" id="L142">  }</span>

  public void setOpaque(JComponent jComponent, boolean opaque) {
<span class="nc" id="L145">    jComponent.setOpaque(opaque);</span>
<span class="nc" id="L146">  }</span>

  /**
   * Sets the grabFocus.
   *
   * @param grabFocus The grabFocus to set
   */
  public void setGrabFocus(Gui4jCall grabFocus) {
<span class="nc" id="L154">    mGrabFocus = grabFocus;</span>
<span class="nc" id="L155">  }</span>

  public void setFocusTraversalKeysForward(Set traversalKeys) {
<span class="nc" id="L158">    mFocusTraversalKeysForward = traversalKeys;</span>
<span class="nc" id="L159">  }</span>

  public void setFocusTraversalKeysBackward(Set traversalKeys) {
<span class="nc" id="L162">    mFocusTraversalKeysBackward = traversalKeys;</span>
<span class="nc" id="L163">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>