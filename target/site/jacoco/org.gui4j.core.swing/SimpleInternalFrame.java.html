<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SimpleInternalFrame.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">gui4j</a> &gt; <a href="index.source.html" class="el_package">org.gui4j.core.swing</a> &gt; <span class="el_source">SimpleInternalFrame.java</span></div><h1>SimpleInternalFrame.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2003 JGoodies Karsten Lentzsch. All Rights Reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 *  o Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer.
 *
 *  o Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 *  o Neither the name of JGoodies Karsten Lentzsch nor the names of
 *    its contributors may be used to endorse or promote products derived
 *    from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
 * OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
 * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

/*
 * Source code changes (c) 2005 beck et al. projects
 */

package org.gui4j.core.swing;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.GradientPaint;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Insets;
import java.awt.LayoutManager;
import java.awt.Paint;
import java.awt.event.MouseListener;
import javax.swing.BorderFactory;
import javax.swing.Icon;
import javax.swing.JComponent;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JToolBar;
import javax.swing.SwingConstants;
import javax.swing.UIManager;
import javax.swing.border.AbstractBorder;

/**
 * A lightweight component derived from JPanel that features certain subcomponents that make it look
 * similar to a frame or internal frame. It shows a titlebar above its content component. The title
 * bar has an optional icon on the left, a title text and an optional toolbar on the right.
 */
public class SimpleInternalFrame extends JPanel {
  private String title;
  private String infoText;

  private JLabel titleLabel;
  private GradientPanel gradientPanel;
  private JPanel headerPanel;
  private boolean isSelected;

  // support for usage as Dockable in FlexDock (see Gui4jPortal)
  private Icon tabIcon;
  private String tabText;
  private Listener listener;

  // Instance Creation ****************************************************

  /** Constructs a &lt;code&gt;SimpleInternalFrame&lt;/code&gt; with an empty title. */
  public SimpleInternalFrame() {
<span class="nc" id="L82">    this(null, &quot;&quot;, null, null);</span>
<span class="nc" id="L83">  }</span>

  /**
   * Constructs a &lt;code&gt;SimpleInternalFrame&lt;/code&gt; with the specified title.
   *
   * @param title the initial name
   */
  public SimpleInternalFrame(String title) {
<span class="nc" id="L91">    this(null, title, null, null);</span>
<span class="nc" id="L92">  }</span>

  /**
   * Constructs a &lt;code&gt;SimpleInternalFrame&lt;/code&gt; with the specified icon, and title.
   *
   * @param icon the initial icon
   * @param title the initial name
   */
  public SimpleInternalFrame(Icon icon, String title) {
<span class="nc" id="L101">    this(icon, title, null, null);</span>
<span class="nc" id="L102">  }</span>

  /**
   * Constructs a &lt;code&gt;SimpleInternalFrame&lt;/code&gt; with the specified title, tool bar, and content
   * panel.
   *
   * @param title the initial name
   * @param bar the initial tool bar
   * @param content the initial content pane
   */
  public SimpleInternalFrame(String title, JToolBar bar, JComponent content) {
<span class="nc" id="L113">    this(null, title, bar, content);</span>
<span class="nc" id="L114">  }</span>

  /**
   * Constructs a &lt;code&gt;SimpleInternalFrame&lt;/code&gt; with the specified icon, title, tool bar, and
   * content panel.
   *
   * @param icon the initial icon
   * @param title the initial title
   * @param bar the initial tool bar
   * @param content the initial content pane
   */
  public SimpleInternalFrame(Icon icon, String title, JToolBar bar, JComponent content) {
<span class="nc" id="L126">    super(new BorderLayout());</span>
<span class="nc" id="L127">    this.isSelected = false;</span>
<span class="nc" id="L128">    this.title = title;</span>
<span class="nc" id="L129">    this.titleLabel = new JLabel(title, icon, SwingConstants.LEADING);</span>
<span class="nc" id="L130">    JPanel top = buildHeader(titleLabel, bar);</span>

<span class="nc" id="L132">    add(top, BorderLayout.NORTH);</span>
<span class="nc bnc" id="L133" title="All 2 branches missed.">    if (content != null) {</span>
<span class="nc" id="L134">      setContent(content);</span>
    }
<span class="nc" id="L136">    setBorder(new ShadowBorder());</span>
<span class="nc" id="L137">    setSelected(true);</span>
<span class="nc" id="L138">    updateHeader();</span>
<span class="nc" id="L139">  }</span>

  // Public API ***********************************************************

  public Listener getListener() {
<span class="nc" id="L144">    return listener;</span>
  }

  public void setListener(Listener listener) {
<span class="nc" id="L148">    this.listener = listener;</span>
<span class="nc" id="L149">  }</span>

  /**
   * Returns the frame's icon.
   *
   * @return the frame's icon
   */
  public Icon getFrameIcon() {
<span class="nc" id="L157">    return titleLabel.getIcon();</span>
  }

  /**
   * Sets a new frame icon.
   *
   * @param newIcon the icon to be set
   */
  public void setFrameIcon(Icon newIcon) {
<span class="nc" id="L166">    Icon oldIcon = getFrameIcon();</span>
<span class="nc" id="L167">    titleLabel.setIcon(newIcon);</span>
<span class="nc" id="L168">    firePropertyChange(&quot;frameIcon&quot;, oldIcon, newIcon);</span>
<span class="nc" id="L169">  }</span>

  public Icon getTabIcon() {
<span class="nc" id="L172">    return tabIcon;</span>
  }

  public void setTabIcon(Icon tabIcon) {
<span class="nc" id="L176">    this.tabIcon = tabIcon;</span>
<span class="nc" id="L177">    notifyListener();</span>
<span class="nc" id="L178">  }</span>

  public String getTabText() {
<span class="nc bnc" id="L181" title="All 4 branches missed.">    if (tabText == null || tabText.length() == 0) {</span>
<span class="nc" id="L182">      return title;</span>
    }
<span class="nc" id="L184">    return tabText;</span>
  }

  public void setTabText(String tabText) {
<span class="nc" id="L188">    this.tabText = tabText;</span>
<span class="nc" id="L189">    notifyListener();</span>
<span class="nc" id="L190">  }</span>

  /**
   * Returns the frame's caption, consisting of its title and, if existent, its info text.
   *
   * @return String the current caption
   */
  public String getCaption() {
<span class="nc" id="L198">    return titleLabel.getText();</span>
  }

  public String getInfoText() {
<span class="nc" id="L202">    return infoText;</span>
  }

  public void setInfoText(String info) {
<span class="nc" id="L206">    this.infoText = info;</span>
<span class="nc" id="L207">    updateCaption();</span>
<span class="nc" id="L208">  }</span>

  public String getTitle() {
<span class="nc" id="L211">    return title;</span>
  }

  public void setTitle(String title) {
<span class="nc" id="L215">    this.title = title;</span>
<span class="nc" id="L216">    updateCaption();</span>
<span class="nc" id="L217">    notifyListener();</span>
<span class="nc" id="L218">  }</span>

  /**
   * Returns the current toolbar, null if none has been set before.
   *
   * @return the current toolbar - if any
   */
  public JToolBar getToolBar() {
<span class="nc bnc" id="L226" title="All 2 branches missed.">    return headerPanel.getComponentCount() &gt; 1 ? (JToolBar) headerPanel.getComponent(1) : null;</span>
  }

  /**
   * Sets a new tool bar in the header.
   *
   * @param newToolBar the tool bar to be set in the header
   */
  public void setToolBar(JToolBar newToolBar) {
<span class="nc" id="L235">    JToolBar oldToolBar = getToolBar();</span>
<span class="nc bnc" id="L236" title="All 2 branches missed.">    if (oldToolBar == newToolBar) {</span>
<span class="nc" id="L237">      return;</span>
    }
<span class="nc bnc" id="L239" title="All 2 branches missed.">    if (oldToolBar != null) {</span>
<span class="nc" id="L240">      headerPanel.remove(oldToolBar);</span>
    }
<span class="nc bnc" id="L242" title="All 2 branches missed.">    if (newToolBar != null) {</span>
<span class="nc" id="L243">      newToolBar.setBorder(BorderFactory.createEmptyBorder(0, 0, 0, 0));</span>
<span class="nc" id="L244">      headerPanel.add(newToolBar, BorderLayout.EAST);</span>
    }
<span class="nc" id="L246">    updateHeader();</span>
<span class="nc" id="L247">    firePropertyChange(&quot;toolBar&quot;, oldToolBar, newToolBar);</span>
<span class="nc" id="L248">  }</span>

  /**
   * Returns the content - null, if none has been set.
   *
   * @return the current content
   */
  public Component getContent() {
<span class="nc bnc" id="L256" title="All 2 branches missed.">    return hasContent() ? getComponent(1) : null;</span>
  }

  /**
   * Sets a new panel content; replaces any existing content, if existing.
   *
   * @param newContent the panel's new content
   */
  public void setContent(Component newContent) {
<span class="nc" id="L265">    Component oldContent = getContent();</span>
<span class="nc bnc" id="L266" title="All 2 branches missed.">    if (hasContent()) {</span>
<span class="nc" id="L267">      remove(oldContent);</span>
    }
<span class="nc" id="L269">    add(newContent, BorderLayout.CENTER);</span>
<span class="nc" id="L270">    firePropertyChange(&quot;content&quot;, oldContent, newContent);</span>
<span class="nc" id="L271">  }</span>

  /**
   * Answers if the panel is currently selected (or in other words active) or not. In the selected
   * state, the header background will be rendered differently.
   *
   * @return boolean a boolean, where true means the frame is selected (currently active) and false
   *     means it is not
   */
  public boolean isSelected() {
<span class="nc" id="L281">    return isSelected;</span>
  }

  /**
   * This panel draws its title bar differently if it is selected, which may be used to indicate to
   * the user that this panel has the focus, or should get more attention than other simple internal
   * frames.
   *
   * @param newValue a boolean, where true means the frame is selected (currently active) and false
   *     means it is not
   */
  public void setSelected(boolean newValue) {
<span class="nc" id="L293">    boolean oldValue = isSelected();</span>
<span class="nc" id="L294">    isSelected = newValue;</span>
<span class="nc" id="L295">    updateHeader();</span>
<span class="nc" id="L296">    firePropertyChange(&quot;selected&quot;, oldValue, newValue);</span>
<span class="nc" id="L297">  }</span>

  public void addHeaderListener(MouseListener mouseListener) {
<span class="nc" id="L300">    gradientPanel.addMouseListener(mouseListener);</span>
<span class="nc" id="L301">  }</span>

  public void setToolTipText(String text) {
<span class="nc" id="L304">    super.setToolTipText(text);</span>
<span class="nc" id="L305">    gradientPanel.setToolTipText(text);</span>
<span class="nc" id="L306">  }</span>

  public void setFont(Font font) {
<span class="nc" id="L309">    super.setFont(font);</span>
<span class="nc bnc" id="L310" title="All 2 branches missed.">    if (titleLabel != null) {</span>
<span class="nc" id="L311">      titleLabel.setFont(font);</span>
    }
<span class="nc" id="L313">  }</span>

  // Building *************************************************************

  /**
   * Creates and answers the header panel, that consists of: an icon, a title label, a tool bar, and
   * a gradient background.
   *
   * @param label the label to paint the icon and text
   * @param bar the panel's tool bar
   * @return the panel's built header area
   */
  private JPanel buildHeader(JLabel label, JToolBar bar) {
<span class="nc" id="L326">    gradientPanel = new GradientPanel(new BorderLayout(), getHeaderBackground());</span>
<span class="nc" id="L327">    label.setOpaque(false);</span>

<span class="nc" id="L329">    gradientPanel.add(label, BorderLayout.WEST);</span>
<span class="nc" id="L330">    gradientPanel.setBorder(BorderFactory.createEmptyBorder(3, 4, 3, 1));</span>

<span class="nc" id="L332">    headerPanel = new JPanel(new BorderLayout());</span>
<span class="nc" id="L333">    headerPanel.add(gradientPanel, BorderLayout.CENTER);</span>
<span class="nc" id="L334">    setToolBar(bar);</span>
<span class="nc" id="L335">    headerPanel.setBorder(new RaisedHeaderBorder());</span>
<span class="nc" id="L336">    headerPanel.setOpaque(false);</span>
<span class="nc" id="L337">    return headerPanel;</span>
  }

  /** Updates the header. */
  private void updateHeader() {
<span class="nc" id="L342">    gradientPanel.setBackground(getHeaderBackground());</span>
<span class="nc" id="L343">    gradientPanel.setOpaque(isSelected());</span>
<span class="nc" id="L344">    titleLabel.setForeground(getTextForeground(isSelected()));</span>
<span class="nc" id="L345">    headerPanel.repaint();</span>

<span class="nc" id="L347">    Dimension minSize = new Dimension(headerPanel.getMinimumSize());</span>
<span class="nc" id="L348">    minSize.height += 3; // border</span>
<span class="nc" id="L349">    setMinimumSize(minSize);</span>
<span class="nc" id="L350">  }</span>

  /**
   * Updates the UI. In addition to the superclass behavior, we need to update the header component.
   */
  public void updateUI() {
<span class="nc" id="L356">    super.updateUI();</span>
<span class="nc bnc" id="L357" title="All 2 branches missed.">    if (titleLabel != null) {</span>
<span class="nc" id="L358">      updateHeader();</span>
    }
<span class="nc" id="L360">  }</span>

  // Helper Code **********************************************************

  /**
   * Checks and answers if the panel has a content component set.
   *
   * @return true if the panel has a content, false if it's empty
   */
  private boolean hasContent() {
<span class="nc bnc" id="L370" title="All 2 branches missed.">    return getComponentCount() &gt; 1;</span>
  }

  /**
   * Determines and answers the header's text foreground color. Tries to lookup a special color from
   * the L&amp;amp;F. In case it is absent, it uses the standard internal frame forground.
   *
   * @param selected true to lookup the active color, false for the inactive
   * @return the color of the foreground text
   */
  protected Color getTextForeground(boolean selected) {
    Color c =
<span class="nc" id="L382">        UIManager.getColor(</span>
<span class="nc bnc" id="L383" title="All 2 branches missed.">            selected</span>
<span class="nc" id="L384">                ? &quot;SimpleInternalFrame.activeTitleForeground&quot;</span>
<span class="nc" id="L385">                : &quot;SimpleInternalFrame.inactiveTitleForeground&quot;);</span>
<span class="nc bnc" id="L386" title="All 2 branches missed.">    if (c != null) {</span>
<span class="nc" id="L387">      return c;</span>
    }
<span class="nc" id="L389">    return UIManager.getColor(</span>
<span class="nc bnc" id="L390" title="All 2 branches missed.">        selected ? &quot;InternalFrame.activeTitleForeground&quot; : &quot;Label.foreground&quot;);</span>
  }

  /**
   * Determines and answers the header's background color. Tries to lookup a special color from the
   * L&amp;amp;F. In case it is absent, it uses the standard internal frame background.
   *
   * @return the color of the header's background
   */
  protected Color getHeaderBackground() {
<span class="nc" id="L400">    Color c = UIManager.getColor(&quot;SimpleInternalFrame.activeTitleBackground&quot;);</span>
<span class="nc bnc" id="L401" title="All 2 branches missed.">    if (c != null) return c;</span>
<span class="nc" id="L402">    c = UIManager.getColor(&quot;InternalFrame.activeTitleGradient&quot;);</span>
<span class="nc bnc" id="L403" title="All 2 branches missed.">    return c != null ? c : UIManager.getColor(&quot;InternalFrame.activeTitleBackground&quot;);</span>
  }

  private void updateCaption() {
<span class="nc" id="L407">    String newCaption = title;</span>
<span class="nc bnc" id="L408" title="All 2 branches missed.">    if (infoText != null) {</span>
<span class="nc" id="L409">      newCaption = newCaption + &quot; (&quot; + infoText + &quot;)&quot;;</span>
    }

<span class="nc" id="L412">    String oldCaption = getCaption();</span>
<span class="nc" id="L413">    titleLabel.setText(newCaption);</span>
<span class="nc" id="L414">    firePropertyChange(&quot;title&quot;, oldCaption, newCaption);</span>
<span class="nc" id="L415">  }</span>

  public Component getDragHandle() {
<span class="nc" id="L418">    return gradientPanel;</span>
  }

  protected String paramString() {
<span class="nc" id="L422">    return getCaption();</span>
  }

  private void notifyListener() {
<span class="nc bnc" id="L426" title="All 2 branches missed.">    if (listener != null) {</span>
<span class="nc" id="L427">      listener.propertiesChanged();</span>
    }
<span class="nc" id="L429">  }</span>

  // Nested Interface ****************************************

  public static interface Listener {
    void propertiesChanged();
  }

  // Helper Classes *******************************************************

  // A custom border for the raised header pseudo 3D effect.
  private static class RaisedHeaderBorder extends AbstractBorder {

<span class="nc" id="L442">    private static final Insets INSETS = new Insets(1, 1, 1, 0);</span>

    public Insets getBorderInsets(Component c) {
<span class="nc" id="L445">      return INSETS;</span>
    }

    public void paintBorder(Component c, Graphics g, int x, int y, int w, int h) {

<span class="nc" id="L450">      g.translate(x, y);</span>
<span class="nc" id="L451">      g.setColor(UIManager.getColor(&quot;controlLtHighlight&quot;));</span>
<span class="nc" id="L452">      g.fillRect(0, 0, w, 1);</span>
<span class="nc" id="L453">      g.fillRect(0, 1, 1, h - 1);</span>
<span class="nc" id="L454">      g.setColor(UIManager.getColor(&quot;controlShadow&quot;));</span>
<span class="nc" id="L455">      g.fillRect(0, h - 1, w, 1);</span>
<span class="nc" id="L456">      g.translate(-x, -y);</span>
<span class="nc" id="L457">    }</span>
  }

  // A panel with a horizontal gradient background.
  private static class GradientPanel extends JPanel {

    private GradientPanel(LayoutManager lm, Color background) {
<span class="nc" id="L464">      super(lm);</span>
<span class="nc" id="L465">      setBackground(background);</span>
<span class="nc" id="L466">    }</span>

    public void paintComponent(Graphics g) {
<span class="nc" id="L469">      super.paintComponent(g);</span>
<span class="nc bnc" id="L470" title="All 2 branches missed.">      if (!isOpaque()) {</span>
<span class="nc" id="L471">        return;</span>
      }
<span class="nc" id="L473">      Color control = UIManager.getColor(&quot;control&quot;);</span>
<span class="nc" id="L474">      int width = getWidth();</span>
<span class="nc" id="L475">      int height = getHeight();</span>

<span class="nc" id="L477">      Graphics2D g2 = (Graphics2D) g;</span>
<span class="nc" id="L478">      Paint storedPaint = g2.getPaint();</span>
<span class="nc" id="L479">      g2.setPaint(new GradientPaint(0, 0, getBackground(), width, 0, control));</span>
<span class="nc" id="L480">      g2.fillRect(0, 0, width, height);</span>
<span class="nc" id="L481">      g2.setPaint(storedPaint);</span>
<span class="nc" id="L482">    }</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>